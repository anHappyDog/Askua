部分代码设计参考`Theseus`